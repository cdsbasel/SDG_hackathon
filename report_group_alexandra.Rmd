---
title: "Unibas SDG Report"
description: "CDS Brown Bag"
output: 
      html_document:
            toc: true
            toc_float: 
              collapsed: false
              smooth_scroll: true
            theme: flatly 
            df_print: paged
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = FALSE)
```

# Introduction

Describe mission: Detect SDGs in research output of the University of Basel per request of Sustainability Office of Unibas.

<img src="https://upload.wikimedia.org/wikipedia/commons/d/df/Sustainable_Development_Goals.png"></img>

### Data
```{r, echo = F}
projects_sdg <- read_csv("0_data/projects_sdg.csv")
publications_sdg <- read_csv("0_data/publications_sdg.csv")
projects_sdg_elsevier <- projects_sdg %>% select(lead:doc_id, `SDG-01-Elsevier`:`SDG-16-Elsevier`) %>% 
  pivot_longer(cols = `SDG-01-Elsevier`:`SDG-16-Elsevier`, names_to = "SDG", values_to = "match")
publications_sdg_elsevier <- publications_sdg %>% select(type:doc_id, `SDG-01-Elsevier`:`SDG-16-Elsevier`) %>% filter(type == "article") %>% pivot_longer(cols = `SDG-01-Elsevier`:`SDG-16-Elsevier`, names_to = "SDG", values_to = "match")
```

Research database & Grants office database

Three files correspinding to different research items: publications, projects (self funded), projects (externally funded)


### Methodological 

Limit to 2010 to 2020

Query search using Aurora (Link) and Elsevier (Link). Goldstandard? What are other Universities doing (Comparable)? Why are they different? Discuss caveats.
 
Conducted using corpustools R package and translations of the queries.

Choice of organizational unit

# Distribution of SDG

```{r, echo = F}
total_articles <- length(unique(publications_sdg_elsevier$doc_id))
total_projects <- length(unique(projects_sdg_elsevier$doc_id))
sdg_project_match <- projects_sdg_elsevier %>% group_by(doc_id) %>% summarise(sum_match = sum(match)) %>% filter(sum_match > 0)
sdg_project_match <- nrow(sdg_project_match)
sdg_publications_match <- publications_sdg_elsevier %>% group_by(doc_id) %>% summarise(sum_match = sum(match)) %>% filter(sum_match > 0)
sdg_publications_match <- nrow(sdg_publications_match)
```
Text including numbers computed using inline code: No. articles, No. of projects, No. of matches (any SDG) in both. 

Text describing results in Figure. 

Figure showing frequency of SDG matches by SDG, output type (publication, self-funded project, externally-funded project), and system (Aurora & Elsevier)
```{r, echo = F, fig.height=10, fig.width= 10}
projects_sdg_elsevier_summary <- projects_sdg_elsevier %>% group_by(SDG,type) %>% summarise(sum_sdg = sum(match),prop_sdg = 100*(sum(match)/total_projects))
publication_sdg_elsevier_summary <- publications_sdg_elsevier %>% group_by(SDG) %>% summarise(sum_sdg = sum(match),prop_sdg = 100*(sum(match)/sdg_publications_match))

publication_sdg_elsevier_summary %>%  ggplot() + geom_bar(aes(y = SDG, x = prop_sdg), stat = "identity") +  labs(title = "Frequency of SDG matches by SDG")
```



# Distribution of SDG across Time

Only meaningful Elsevir

# Distribution of SDG by organizational unit

Text describing organizational units incl. inline computed numbers. 

Text describing results in Figure. 

Figure showing frequency of SDGs by unit.

Interdisciplinarity (one unit versus multiple units?)


